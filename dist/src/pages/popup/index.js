var k=Object.defineProperty;var p=(i,e,o)=>e in i?k(i,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[e]=o;var a=(i,e,o)=>(p(i,typeof e!="symbol"?e+"":e,o),o);import{r as c,b as r,j as t,n as m,a as h}from"../../../assets/js/event.js";import{e as u,O as B,g as C,d as g,f as N,a as f,B as v}from"../../../assets/js/bookController.js";import{o as b,A as D}from"../../../assets/js/webdav.js";import{i as I}from"../../../assets/js/sync.js";const l=chrome.runtime.getURL("newtab.html");class O extends c.exports.Component{constructor(o,s){super(o,s);a(this,"state",{currentBookId:0,bookList:[]})}loadBook(o){u().then(s=>{s.code===B.code&&this.setState({currentBookId:o,bookList:s.data})})}componentDidMount(){C().then(o=>{this.loadBook(o)}),b(()=>{I()&&m({action:D.START_SYNC})})}onBookClick(o){this.setState({currentBookId:o.id}),g(o.id).then(()=>{console.log("save successfully!")})}onBookDeleteClick(o,s){o.stopPropagation(),o.preventDefault(),N(s.id).then(n=>{this.loadBook(this.state.currentBookId)})}onBookOrderClick(o,s,n){o.stopPropagation(),o.preventDefault(),f(s.id,{mode:n}).then(d=>{this.loadBook(this.state.currentBookId),console.log(d)})}render(){return r("div",{className:"popupContainer",children:[t("div",{className:"app-title",children:r("a",{className:"logo-wrap",href:l,target:"_blank",children:[t("i",{className:"icon-app"}),t("div",{className:"text",children:"Rambler"})]})}),this.state.bookList.length?t(L,{currentId:this.state.currentBookId,list:this.state.bookList,onBookClick:this.onBookClick.bind(this),onBookDeleteClick:this.onBookDeleteClick.bind(this),onBookOrderClick:this.onBookOrderClick.bind(this)}):t(x,{})]})}}function x(){return r("div",{className:"nodata",children:[t("div",{className:"msg",children:"No Data"}),t("button",{onClick:()=>{window.open(l)},className:"btn-add",children:"+ Add Book"})]})}class L extends c.exports.Component{render(){return t("div",{className:"book-list",children:this.props.list.map((e,o)=>{const s=["book-item",e.id===this.props.currentId?"selected":""].join(" ");return r("div",{className:s,onClick:()=>this.props.onBookClick(e),children:[e.name.split(".")[0],r("div",{className:"icons",children:[e.mode===v.INORDER?t("img",{className:"icon icon-order",src:"/img/icon/inorder.svg",alt:"",onClick:n=>this.props.onBookOrderClick(n,e,0)}):t("img",{className:"icon icon-order",src:"/img/icon/shuffle.svg",alt:"",onClick:n=>this.props.onBookOrderClick(n,e,1)}),t("img",{className:"icon icon-close",src:"/img/icon/delete.svg",alt:"",onClick:n=>this.props.onBookDeleteClick(n,e)})]})]},o)})})}}chrome.tabs.query({active:!0,currentWindow:!0},i=>{h.exports.render(t(O,{}),document.getElementById("popup"))});
//# sourceMappingURL=index.js.map
